@model TechShop.Models.Order
@{
    ViewData["Title"] = "Помилка оплати";
}

<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card border-danger">
                <div class="card-header bg-danger text-white text-center">
                    <h4><i class="fas fa-times-circle me-2"></i>Помилка оплати</h4>
                </div>
                <div class="card-body">
                    <div class="text-center mb-4">
                        <div class="alert alert-danger">
                            <h5 class="mb-3">На жаль, оплата не пройшла</h5>
                            <p class="mb-2">Номер замовлення: <strong>#@Model.Id</strong></p>
                            <p class="mb-0">Можливі причини: недостатньо коштів, технічні проблеми банку, або інші причини</p>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <h6>Деталі замовлення:</h6>
                            <ul class="list-unstyled">
                                @foreach (var item in Model.OrderItems)
                                {
                                    <li class="d-flex justify-content-between py-2">
                                        <span>@item.Product?.Name x @item.Quantity</span>
                                        <span>@((item.Price * item.Quantity).ToString("C", new System.Globalization.CultureInfo("uk-UA")))</span>
                                    </li>
                                }
                            </ul>
                            <hr>
                            <div class="d-flex justify-content-between">
                                <strong>Сума до оплати:</strong>
                                <strong>@Model.TotalWithDelivery.ToString("C", new System.Globalization.CultureInfo("uk-UA"))</strong>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <h6>Статус оплати:</h6>
                            @if (Model.Payment != null)
                            {
                                <p><strong>Спосіб оплати:</strong> Картка онлайн</p>
                                <p><strong>Поточний статус:</strong> 
                                    <span class="badge bg-danger">Не оплачено</span>
                                </p>
                                @if (Model.Payment.ProcessedAt.HasValue)
                                {
                                    <p><strong>Час спроби:</strong> @Model.Payment.ProcessedAt.Value.ToString("dd.MM.yyyy HH:mm")</p>
                                }
                            }
                        </div>
                    </div>

                    <div class="text-center mt-4">
                        <div class="alert alert-warning">
                            <h6>Що робити далі?</h6>
                            <p class="mb-2">• Перевірте баланс карти та спробуйте ще раз</p>
                            <p class="mb-2">• Використайте іншу карту для оплати</p>
                            <p class="mb-2">• Оберіть оплату готівкою при отриманні</p>
                            <p class="mb-0">• Зверніться до нас за телефоном для вирішення проблеми</p>
                        </div>
                        
                        <div class="mt-3">
                            <a href="@Url.Action("PayWithCard", "Checkout", new { orderId = Model.Id })" class="btn btn-primary me-2">
                                <i class="fas fa-credit-card me-1"></i>Спробувати ще раз
                            </a>
                            <a href="@Url.Action("Index", "ShoppingCart")" class="btn btn-outline-secondary me-2">Повернутися в кошик</a>
                            <a href="@Url.Action("Index", "Contact")" class="btn btn-outline-info">Зв'язатися з нами</a>
                        </div>

                        <div class="mt-3">
                            <small class="text-muted">
                                Ваше замовлення збережено. Ви можете завершити оплату пізніше.
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>